import { drizzle } from 'drizzle-orm/postgres-js'
import postgres from 'postgres'
import * as schema from './schema'

// Database connection
const connectionString = process.env.DATABASE_URL
if (!connectionString) {
  throw new Error('DATABASE_URL environment variable is not set')
}

const client = postgres(connectionString)
const db = drizzle(client, { schema })

async function seed() {
  console.log('üå± Starting database seeding...')

  try {
    // 1. Seed Roles
    console.log('üìã Seeding roles...')
    const rolesData = [
      {
        name: 'owner',
        description: 'Administr√°tor organiz√°cie s pln√Ωm pr√≠stupom',
        permissions: { all: true },
      },
      {
        name: 'admin',
        description: 'Tajomn√≠k v√Ωberovej komisie s pr√≠stupom k spr√°ve',
        permissions: { manage_users: true, manage_procedures: true, manage_surveys: true },
      },
      {
        name: 'member',
        description: 'ƒålen komisie so ≈°tandardn√Ωm pr√≠stupom',
        permissions: { view_procedures: true, view_surveys: true },
      },
      {
        name: 'viewer',
        description: 'Pr√≠stup iba na ƒç√≠tanie',
        permissions: { view_only: true },
      },
    ]

    const roles = await db.insert(schema.roles).values(rolesData).returning()
    console.log(`‚úÖ Created ${roles.length} roles`)

    // 2. Seed Organizations
    console.log('üè¢ Seeding organizations...')
    const organizationsData = [
      { name: 'Ministerstvo invest√≠ci√≠, region√°lneho rozvoja a informatiz√°cie SR', slug: 'mirri' },
      { name: '√örad vl√°dy Slovenskej republiky', slug: 'uv-sr' },
      { name: 'Ministerstvo financi√≠ SR', slug: 'mf-sr' },
    ]

    const organizations = await db.insert(schema.organizations).values(organizationsData).returning()
    console.log(`‚úÖ Created ${organizations.length} organizations`)

    // 3. Seed Users
    console.log('üë§ Seeding users...')
    const usersData = [
      {
        name: 'J√°n Nov√°k',
        email: 'jan.novak@mirri.gov.sk',
        password: 'password123',
        avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Jan',
        currentOrganizationId: organizations[0].id,
      },
      {
        name: 'M√°ria Horv√°thov√°',
        email: 'maria.horvathova@mirri.gov.sk',
        password: 'password123',
        avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Maria',
        currentOrganizationId: organizations[0].id,
      },
      {
        name: 'Peter Kov√°cs',
        email: 'peter.kovacs@vlada.gov.sk',
        password: 'password123',
        avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Peter',
        currentOrganizationId: organizations[1].id,
      },
      {
        name: 'Eva T√≥thov√°',
        email: 'eva.tothova@mfsr.sk',
        password: 'password123',
        avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Eva',
        currentOrganizationId: organizations[2].id,
      },
    ]

    const users = await db.insert(schema.users).values(usersData).returning()
    console.log(`‚úÖ Created ${users.length} users`)

    // 4. Seed User-Organization relationships
    console.log('üîó Seeding user-organization relationships...')
    const ownerRole = roles.find(r => r.name === 'owner')!
    const adminRole = roles.find(r => r.name === 'admin')!
    const memberRole = roles.find(r => r.name === 'member')!

    const userOrganizationsData = [
      { userId: users[0].id, organizationId: organizations[0].id, roleId: ownerRole.id },
      { userId: users[1].id, organizationId: organizations[0].id, roleId: adminRole.id },
      { userId: users[2].id, organizationId: organizations[1].id, roleId: ownerRole.id },
      { userId: users[3].id, organizationId: organizations[2].id, roleId: ownerRole.id },
    ]

    const userOrganizations = await db.insert(schema.userOrganizations).values(userOrganizationsData).returning()
    console.log(`‚úÖ Created ${userOrganizations.length} user-organization relationships`)

    // 5. Seed Surveys (Written Exam Tests)
    console.log('üìä Seeding surveys...')
    const surveysData = [
      {
        title: 'Odborn√Ω test',
        category: 'professional_knowledge',
        status: 'approved',
        jsonData: {
          title: 'Odborn√Ω test',
          description: 'Test odborn√Ωch znalost√≠',
          showTimer: true,
          maxTimeToFinish: 1200, // 20 minutes in seconds
          pages: [{
            name: 'page1',
            elements: [
              {
                type: 'radiogroup',
                name: 'q1',
                title: 'ƒåo je to projekt podƒæa metodiky PRINCE2?',
                correctAnswer: 'answer_a',
                isRequired: true,
                choices: [
                  { value: 'answer_a', text: 'Doƒçasn√° organiz√°cia s cieƒæom doruƒçi≈• produkty' },
                  { value: 'answer_b', text: 'Trval√° organiz√°cia bez definovan√©ho konca' },
                  { value: 'answer_c', text: 'S√∫bor √∫loh bez ƒçasov√©ho r√°mca' },
                  { value: 'answer_d', text: 'Neform√°lne stretnutie pracovnej skupiny' },
                ],
              },
              {
                type: 'radiogroup',
                name: 'q2',
                title: 'Ak√Ω je hlavn√Ω √∫ƒçel projektov√©ho mana≈æmentu?',
                correctAnswer: 'answer_b',
                isRequired: true,
                choices: [
                  { value: 'answer_a', text: 'Zn√≠≈æi≈• poƒçet zamestnancov' },
                  { value: 'answer_b', text: 'Zabezpeƒçi≈• √∫spe≈°n√© doruƒçenie projektov√Ωch v√Ωstupov' },
                  { value: 'answer_c', text: 'Zv√Ω≈°i≈• administrat√≠vnu z√°≈•a≈æ' },
                  { value: 'answer_d', text: 'Predƒ∫≈æi≈• trvanie projektu' },
                ],
              },
              {
                type: 'checkbox',
                name: 'q3',
                title: 'Ktor√© z nasleduj√∫cich s√∫ f√°zy projektu? (Oznaƒçte v≈°etky spr√°vne)',
                correctAnswer: ['answer_a', 'answer_b', 'answer_d'],
                choices: [
                  { value: 'answer_a', text: 'Inicializ√°cia' },
                  { value: 'answer_b', text: 'Pl√°novanie' },
                  { value: 'answer_c', text: 'Procrastin√°cia' },
                  { value: 'answer_d', text: 'Realiz√°cia' },
                  { value: 'answer_e', text: '≈†pekul√°cia' },
                ],
              },
            ],
          }],
        },
        organizationId: organizations[0].id,
        createdById: users[0].id,
      },
      {
        title: 'V≈°eobecn√Ω test',
        category: 'general_knowledge',
        status: 'approved',
        jsonData: {
          title: 'V≈°eobecn√Ω test',
          description: 'Test v≈°eobecn√Ωch znalost√≠',
          showTimer: true,
          maxTimeToFinish: 900, // 15 minutes in seconds
          pages: [{
            name: 'page1',
            elements: [
              {
                type: 'radiogroup',
                name: 'q1',
                title: 'V ktorom roku sa Slovensko stalo ƒçlenom E√ö?',
                correctAnswer: 'answer_c',
                isRequired: true,
                choices: [
                  { value: 'answer_a', text: '2000' },
                  { value: 'answer_b', text: '2002' },
                  { value: 'answer_c', text: '2004' },
                  { value: 'answer_d', text: '2007' },
                ],
              },
              {
                type: 'radiogroup',
                name: 'q2',
                title: 'Kto je s√∫ƒçasn√Ω prezident Slovenskej republiky?',
                correctAnswer: 'answer_a',
                isRequired: true,
                choices: [
                  { value: 'answer_a', text: 'Peter Pellegrini' },
                  { value: 'answer_b', text: 'Zuzana ƒåaputov√°' },
                  { value: 'answer_c', text: 'Andrej Kiska' },
                  { value: 'answer_d', text: 'Ivan Ga≈°paroviƒç' },
                ],
              },
            ],
          }],
        },
        organizationId: organizations[0].id,
        createdById: users[0].id,
      },
      {
        title: 'Test zo ≈°t√°tneho jazyka',
        category: 'state_language',
        status: 'approved',
        jsonData: {
          title: 'Test zo ≈°t√°tneho jazyka',
          description: 'Test znalosti slovensk√©ho jazyka',
          showTimer: true,
          maxTimeToFinish: 300, // 5 minutes in seconds
          pages: [{
            name: 'page1',
            elements: [
              {
                type: 'radiogroup',
                name: 'q1',
                title: 'Ktor√© slovo je nap√≠san√© spr√°vne?',
                correctAnswer: 'answer_b',
                isRequired: true,
                choices: [
                  { value: 'answer_a', text: 'dnesn√Ω de≈à' },
                  { value: 'answer_b', text: 'dne≈°n√Ω de≈à' },
                  { value: 'answer_c', text: 'dne≈°n√≠ de≈à' },
                  { value: 'answer_d', text: 'dne≈°n√Ω d≈àe≈à' },
                ],
              },
            ],
          }],
        },
        organizationId: organizations[0].id,
        createdById: users[0].id,
      },
    ]

    const surveys = await db.insert(schema.surveys).values(surveysData).returning()
    console.log(`‚úÖ Created ${surveys.length} surveys`)

    // 6. Seed Procedures
    console.log('üìù Seeding procedures...')
    const proceduresData = [
      {
        identifier: 'VK/2025/0001',
        title: 'hlavn√Ω ≈°t√°tny radca',
        description: 'V√Ωberov√© konanie na poz√≠ciu hlavn√©ho ≈°t√°tneho radcu',
        status: 'active',
        procedureType: '≈°ir≈°ie vn√∫torn√© v√Ωberov√© konanie',
        organizationalUnit: 'Odbor implement√°cie OKP',
        civilServiceSector: '1.03 ‚Äì Medzin√°rodn√° spolupr√°ca, finanƒçn√© prostriedky Eur√≥pskej √∫nie',
        positionTitle: 'hlavn√Ω ≈°t√°tny radca',
        serviceType: 'st√°la ≈°t√°tna slu≈æba',
        numberOfPositions: 1,
        organizationId: organizations[0].id,
        createdById: users[0].id,
      },
      {
        identifier: 'VK/2025/0002',
        title: '≈°t√°tny radca',
        description: 'V√Ωberov√© konanie na poz√≠ciu ≈°t√°tneho radcu',
        status: 'active',
        procedureType: 'vn√∫torn√© v√Ωberov√© konanie',
        organizationalUnit: 'Odbor kontroly a auditu',
        civilServiceSector: '1.07 ‚Äì Kontrola, dozor, s≈•a≈ænosti, pet√≠cie a audit',
        positionTitle: '≈°t√°tny radca',
        serviceType: 'st√°la ≈°t√°tna slu≈æba',
        numberOfPositions: 2,
        organizationId: organizations[0].id,
        createdById: users[1].id,
      },
      {
        identifier: 'VK/2025/0003',
        title: 'referent',
        description: 'V√Ωberov√© konanie na poz√≠ciu referenta',
        status: 'draft',
        procedureType: 'vonkaj≈°ie v√Ωberov√© konanie',
        organizationalUnit: 'Odbor personalistiky',
        civilServiceSector: '1.12 ‚Äì Riadenie ƒæudsk√Ωch zdrojov',
        positionTitle: 'referent',
        serviceType: 'doƒçasn√° ≈°t√°tna slu≈æba',
        numberOfPositions: 1,
        organizationId: organizations[1].id,
        createdById: users[2].id,
      },
    ]

    const procedures = await db.insert(schema.procedures).values(proceduresData).returning()
    console.log(`‚úÖ Created ${procedures.length} procedures`)

    // 7. Seed Procedure Surveys (link surveys to procedures)
    console.log('üîó Seeding procedure surveys...')
    const procedureSurveysData = [
      // Procedure 1 has all 3 tests
      { procedureId: procedures[0].id, surveyId: surveys[0].id, order: 0, timeLimit: 20, totalPoints: 3, passingScore: 2 },
      { procedureId: procedures[0].id, surveyId: surveys[1].id, order: 1, timeLimit: 15, totalPoints: 2, passingScore: 1 },
      { procedureId: procedures[0].id, surveyId: surveys[2].id, order: 2, timeLimit: 5, totalPoints: 1, passingScore: 1 },
      // Procedure 2 has 2 tests
      { procedureId: procedures[1].id, surveyId: surveys[0].id, order: 0, timeLimit: 20, totalPoints: 3, passingScore: 2 },
      { procedureId: procedures[1].id, surveyId: surveys[1].id, order: 1, timeLimit: 15, totalPoints: 2, passingScore: 1 },
    ]

    const procedureSurveys = await db.insert(schema.procedureSurveys).values(procedureSurveysData).returning()
    console.log(`‚úÖ Created ${procedureSurveys.length} procedure-survey links`)

    // 8. Seed Exam Criteria (oral exam categories)
    console.log('üìã Seeding exam criteria...')
    const examCriteriaData = [
      // Procedure 1 - oral exam criteria
      { procedureId: procedures[0].id, name: 'Samostatnos≈•', minRating: 1, maxRating: 5 },
      { procedureId: procedures[0].id, name: 'Komunik√°cia', minRating: 1, maxRating: 5 },
      { procedureId: procedures[0].id, name: 'Analytick√© myslenie', minRating: 1, maxRating: 5 },
      { procedureId: procedures[0].id, name: 'Flexibilita', minRating: 1, maxRating: 5 },
      { procedureId: procedures[0].id, name: 'Zodpovednos≈•', minRating: 1, maxRating: 5 },
      // Procedure 2
      { procedureId: procedures[1].id, name: 'Samostatnos≈•', minRating: 1, maxRating: 5 },
      { procedureId: procedures[1].id, name: 'Komunik√°cia', minRating: 1, maxRating: 5 },
      { procedureId: procedures[1].id, name: 'Kritick√© myslenie', minRating: 1, maxRating: 5 },
      { procedureId: procedures[1].id, name: 'T√≠mov√° pr√°ca', minRating: 1, maxRating: 5 },
      // Procedure 3
      { procedureId: procedures[2].id, name: 'Uƒçenlivos≈•', minRating: 1, maxRating: 5 },
      { procedureId: procedures[2].id, name: 'Motiv√°cia', minRating: 1, maxRating: 5 },
      { procedureId: procedures[2].id, name: 'Zodpovednos≈•', minRating: 1, maxRating: 5 },
    ]

    const examCriteria = await db.insert(schema.examCriteria).values(examCriteriaData).returning()
    console.log(`‚úÖ Created ${examCriteria.length} exam criteria`)

    // 9. Seed Contenders (with CIS identifiers for access)
    console.log('üë• Seeding contenders...')
    const contendersData = [
      // Procedure 1 contenders
      {
        cisIdentifier: 'UC-2025-0001',
        name: 'Anna Nov√°kov√°',
        email: 'anna.novakova@email.com',
        phone: '+421901123456',
        status: 'testing',
        notes: 'Siln√° kandid√°tka s technick√Ωm vzdelan√≠m',
        procedureId: procedures[0].id,
      },
      {
        cisIdentifier: 'UC-2025-0002',
        name: 'Peter Horv√°th',
        email: 'peter.horvath@email.com',
        phone: '+421902234567',
        status: 'registered',
        notes: 'ƒåak√° na testovanie',
        procedureId: procedures[0].id,
      },
      {
        cisIdentifier: 'UC-2025-0003',
        name: 'Jana Kov√°ƒçov√°',
        email: 'jana.kovacova@email.com',
        phone: '+421903345678',
        status: 'passed_written',
        notes: '√öspe≈°ne absolvovala p√≠somn√© testy, ƒçak√° na √∫stny pohovor',
        procedureId: procedures[0].id,
      },
      {
        cisIdentifier: 'UC-2025-0004',
        name: 'Martin Szab√≥',
        email: 'martin.szabo@email.com',
        phone: '+421904456789',
        status: 'failed_written',
        notes: 'Ne√∫spe≈°n√Ω v p√≠somn√Ωch testoch',
        procedureId: procedures[0].id,
      },
      // Procedure 2 contenders
      {
        cisIdentifier: 'UC-2025-0005',
        name: 'Eva M√©sz√°rosov√°',
        email: 'eva.meszarosova@email.com',
        phone: '+421905567890',
        status: 'testing',
        notes: 'Siln√° komunik√°cia, sk√∫senosti s riaden√≠m projektov',
        procedureId: procedures[1].id,
      },
      {
        cisIdentifier: 'UC-2025-0006',
        name: 'Luk√°≈° Varga',
        email: 'lukas.varga@email.com',
        phone: '+421906678901',
        status: 'registered',
        notes: 'ƒåak√° na testovanie',
        procedureId: procedures[1].id,
      },
      // Procedure 3 contenders
      {
        cisIdentifier: 'UC-2025-0007',
        name: 'Zuzana Moln√°rov√°',
        email: 'zuzana.molnarova@email.com',
        phone: '+421907789012',
        status: 'registered',
        notes: '≈†tudentka, vysok√° motiv√°cia',
        procedureId: procedures[2].id,
      },
    ]

    const contenders = await db.insert(schema.contenders).values(contendersData).returning()
    console.log(`‚úÖ Created ${contenders.length} contenders`)

    // 9. Seed Contender Files
    console.log('üìÑ Seeding contender files...')
    const contenderFilesData = [
      {
        contenderId: contenders[0].id,
        fileName: 'zivotopis_anna_novakova.pdf',
        fileType: 'application/pdf',
        fileSize: 245678,
        fileUrl: 'https://example.com/files/zivotopis_anna_novakova.pdf',
      },
      {
        contenderId: contenders[0].id,
        fileName: 'certifikaty_anna_novakova.pdf',
        fileType: 'application/pdf',
        fileSize: 567890,
        fileUrl: 'https://example.com/files/certifikaty_anna_novakova.pdf',
      },
      {
        contenderId: contenders[1].id,
        fileName: 'zivotopis_peter_horvath.pdf',
        fileType: 'application/pdf',
        fileSize: 189456,
        fileUrl: 'https://example.com/files/zivotopis_peter_horvath.pdf',
      },
      {
        contenderId: contenders[2].id,
        fileName: 'zivotopis_jana_kovacova.pdf',
        fileType: 'application/pdf',
        fileSize: 234567,
        fileUrl: 'https://example.com/files/zivotopis_jana_kovacova.pdf',
      },
      {
        contenderId: contenders[4].id,
        fileName: 'zivotopis_eva_meszarosova.pdf',
        fileType: 'application/pdf',
        fileSize: 198765,
        fileUrl: 'https://example.com/files/zivotopis_eva_meszarosova.pdf',
      },
    ]

    const contenderFiles = await db.insert(schema.contenderFiles).values(contenderFilesData).returning()
    console.log(`‚úÖ Created ${contenderFiles.length} contender files`)

    // 10. Seed Survey Responses (completed test results)
    console.log('üìù Seeding survey responses...')
    const surveyResponsesData = [
      // Anna Nov√°kov√° (contenders[0]) - Completed all 3 tests with good scores
      {
        contenderId: contenders[0].id,
        surveyId: surveys[0].id, // Odborn√Ω test
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_a', q2: 'answer_b', q3: ['answer_a', 'answer_b', 'answer_d'] },
        score: 3,
        isPassed: 1,
        startedAt: new Date('2025-01-10T10:00:00'),
        submittedAt: new Date('2025-01-10T10:15:00'),
        timeSpentSeconds: 900,
      },
      {
        contenderId: contenders[0].id,
        surveyId: surveys[1].id, // V≈°eobecn√Ω test
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_c', q2: 'answer_a' },
        score: 2,
        isPassed: 1,
        startedAt: new Date('2025-01-10T10:20:00'),
        submittedAt: new Date('2025-01-10T10:30:00'),
        timeSpentSeconds: 600,
      },
      {
        contenderId: contenders[0].id,
        surveyId: surveys[2].id, // Test zo ≈°t√°tneho jazyka
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_b' },
        score: 1,
        isPassed: 1,
        startedAt: new Date('2025-01-10T10:35:00'),
        submittedAt: new Date('2025-01-10T10:38:00'),
        timeSpentSeconds: 180,
      },
      // Jana Kov√°ƒçov√° (contenders[2]) - Passed all tests
      {
        contenderId: contenders[2].id,
        surveyId: surveys[0].id,
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_a', q2: 'answer_b', q3: ['answer_a', 'answer_b', 'answer_d'] },
        score: 3,
        isPassed: 1,
        startedAt: new Date('2025-01-11T09:00:00'),
        submittedAt: new Date('2025-01-11T09:18:00'),
        timeSpentSeconds: 1080,
      },
      {
        contenderId: contenders[2].id,
        surveyId: surveys[1].id,
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_c', q2: 'answer_a' },
        score: 2,
        isPassed: 1,
        startedAt: new Date('2025-01-11T09:20:00'),
        submittedAt: new Date('2025-01-11T09:32:00'),
        timeSpentSeconds: 720,
      },
      {
        contenderId: contenders[2].id,
        surveyId: surveys[2].id,
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_b' },
        score: 1,
        isPassed: 1,
        startedAt: new Date('2025-01-11T09:35:00'),
        submittedAt: new Date('2025-01-11T09:39:00'),
        timeSpentSeconds: 240,
      },
      // Martin Szab√≥ (contenders[3]) - Failed professional test
      {
        contenderId: contenders[3].id,
        surveyId: surveys[0].id,
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_c', q2: 'answer_a', q3: ['answer_b'] }, // Wrong answers
        score: 0,
        isPassed: 0,
        startedAt: new Date('2025-01-12T14:00:00'),
        submittedAt: new Date('2025-01-12T14:12:00'),
        timeSpentSeconds: 720,
      },
      {
        contenderId: contenders[3].id,
        surveyId: surveys[1].id,
        procedureId: procedures[0].id,
        responseData: { q1: 'answer_b', q2: 'answer_c' }, // 0/2 correct
        score: 0,
        isPassed: 0,
        startedAt: new Date('2025-01-12T14:15:00'),
        submittedAt: new Date('2025-01-12T14:25:00'),
        timeSpentSeconds: 600,
      },
      // Eva M√©sz√°rosov√° (contenders[4]) - Completed 2 tests for procedure 2
      {
        contenderId: contenders[4].id,
        surveyId: surveys[0].id,
        procedureId: procedures[1].id,
        responseData: { q1: 'answer_a', q2: 'answer_b', q3: ['answer_a', 'answer_b', 'answer_d'] },
        score: 3,
        isPassed: 1,
        startedAt: new Date('2025-01-13T11:00:00'),
        submittedAt: new Date('2025-01-13T11:17:00'),
        timeSpentSeconds: 1020,
      },
      {
        contenderId: contenders[4].id,
        surveyId: surveys[1].id,
        procedureId: procedures[1].id,
        responseData: { q1: 'answer_c', q2: 'answer_a' },
        score: 2,
        isPassed: 1,
        startedAt: new Date('2025-01-13T11:20:00'),
        submittedAt: new Date('2025-01-13T11:28:00'),
        timeSpentSeconds: 480,
      },
    ]

    const surveyResponses = await db.insert(schema.surveyResponses).values(surveyResponsesData).returning()
    console.log(`‚úÖ Created ${surveyResponses.length} survey responses`)

    // 11. Seed Exam Scores (oral exam ratings)
    console.log('‚≠ê Seeding exam scores...')
    const examScoresData = [
      // Anna Nov√°kov√° (contenders[0]) - High ratings
      { contenderId: contenders[0].id, criteriaId: examCriteria[0].id, score: 5, evaluatedById: users[0].id },
      { contenderId: contenders[0].id, criteriaId: examCriteria[1].id, score: 4, evaluatedById: users[0].id },
      { contenderId: contenders[0].id, criteriaId: examCriteria[2].id, score: 5, evaluatedById: users[0].id },
      { contenderId: contenders[0].id, criteriaId: examCriteria[3].id, score: 4, evaluatedById: users[0].id },
      { contenderId: contenders[0].id, criteriaId: examCriteria[4].id, score: 5, evaluatedById: users[0].id },
      // Jana Kov√°ƒçov√° (contenders[2]) - Excellent ratings
      { contenderId: contenders[2].id, criteriaId: examCriteria[0].id, score: 5, evaluatedById: users[1].id },
      { contenderId: contenders[2].id, criteriaId: examCriteria[1].id, score: 5, evaluatedById: users[1].id },
      { contenderId: contenders[2].id, criteriaId: examCriteria[2].id, score: 5, evaluatedById: users[1].id },
      { contenderId: contenders[2].id, criteriaId: examCriteria[3].id, score: 4, evaluatedById: users[1].id },
      { contenderId: contenders[2].id, criteriaId: examCriteria[4].id, score: 5, evaluatedById: users[1].id },
      // Eva M√©sz√°rosov√° (contenders[4]) - Good ratings for procedure 2
      { contenderId: contenders[4].id, criteriaId: examCriteria[5].id, score: 5, evaluatedById: users[1].id },
      { contenderId: contenders[4].id, criteriaId: examCriteria[6].id, score: 4, evaluatedById: users[1].id },
      { contenderId: contenders[4].id, criteriaId: examCriteria[7].id, score: 5, evaluatedById: users[1].id },
      { contenderId: contenders[4].id, criteriaId: examCriteria[8].id, score: 4, evaluatedById: users[1].id },
    ]

    const examScores = await db.insert(schema.examScores).values(examScoresData).returning()
    console.log(`‚úÖ Created ${examScores.length} exam scores`)

    // 11. Seed Question Battery
    console.log('‚ùì Seeding question battery...')
    const questionBatteryData = [
      // Samostatnos≈• - questions about independence and self-reliance
      { categorySlug: 'samostatnost', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste museli samostatne vyrie≈°i≈• zlo≈æit√Ω probl√©m bez pomoci nadriaden√Ωch.', questionEn: 'Describe a situation where you had to independently solve a complex problem without supervisor help.', order: 1 },
      { categorySlug: 'samostatnost', questionSk: 'Ako organizujete svoju pr√°cu, keƒè m√°te viacero d√¥le≈æit√Ωch √∫loh naraz?', questionEn: 'How do you organize your work when you have multiple important tasks at once?', order: 2 },
      { categorySlug: 'samostatnost', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste prevzali iniciat√≠vu v projekte alebo √∫lohe.', questionEn: 'Tell us about a situation where you took initiative in a project or task.', order: 3 },
      { categorySlug: 'samostatnost', questionSk: 'Ako si stanovujete priority pri samostatnej pr√°ci?', questionEn: 'How do you set priorities when working independently?', order: 4 },

      // Komunik√°cia - questions about communication skills
      { categorySlug: 'komunikacia', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste museli komunikova≈• zlo≈æit√© inform√°cie obƒçanom alebo kolegom.', questionEn: 'Describe a situation where you had to communicate complex information to citizens or colleagues.', order: 1 },
      { categorySlug: 'komunikacia', questionSk: 'Ako rie≈°ite nedorozumenia alebo konfliktn√© situ√°cie v komunik√°cii?', questionEn: 'How do you resolve misunderstandings or conflict situations in communication?', order: 2 },
      { categorySlug: 'komunikacia', questionSk: 'Ak√Ω je v√°≈° pr√≠stup k p√≠somnej komunik√°cii (emaily, spr√°vy, dokumenty)?', questionEn: 'What is your approach to written communication (emails, reports, documents)?', order: 3 },
      { categorySlug: 'komunikacia', questionSk: 'Ako prezentujete svoje n√°vrhy a n√°pady kolegom alebo vedeniu?', questionEn: 'How do you present your proposals and ideas to colleagues or management?', order: 4 },

      // Analytick√© myslenie - questions about analytical thinking
      { categorySlug: 'analyticke_myslenie', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste museli analyzova≈• komplexn√Ω probl√©m a navrhn√∫≈• rie≈°enie.', questionEn: 'Describe a situation where you had to analyze a complex problem and propose a solution.', order: 1 },
      { categorySlug: 'analyticke_myslenie', questionSk: 'Ako pristupujete k vyhodnocovaniu r√¥znych mo≈ænost√≠ pri rozhodovan√≠?', questionEn: 'How do you approach evaluating different options when making decisions?', order: 2 },
      { categorySlug: 'analyticke_myslenie', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste identifikovali probl√©m, ktor√Ω in√≠ prehliadli.', questionEn: 'Tell us about a situation where you identified a problem that others overlooked.', order: 3 },
      { categorySlug: 'analyticke_myslenie', questionSk: 'Ak√© analytick√© n√°stroje alebo met√≥dy pou≈æ√≠vate pri rie≈°en√≠ probl√©mov?', questionEn: 'What analytical tools or methods do you use when solving problems?', order: 4 },

      // Flexibilita - questions about flexibility and adaptability
      { categorySlug: 'flexibilita', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste sa museli r√Ωchlo prisp√¥sobi≈• zmen√°m v pr√°ci alebo projekte.', questionEn: 'Describe a situation where you had to quickly adapt to changes at work or in a project.', order: 1 },
      { categorySlug: 'flexibilita', questionSk: 'Ako reagujete, keƒè sa priority va≈°ej pr√°ce zmenia v kr√°tkodobom horizonte?', questionEn: 'How do you react when your work priorities change in the short term?', order: 2 },
      { categorySlug: 'flexibilita', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste museli pracova≈• s nov√Ωmi n√°strojmi alebo met√≥dami.', questionEn: 'Tell us about a situation where you had to work with new tools or methods.', order: 3 },
      { categorySlug: 'flexibilita', questionSk: 'Ako sa vyrovn√°vate s neistotou a zmenami v pracovnom prostred√≠?', questionEn: 'How do you cope with uncertainty and changes in the work environment?', order: 4 },

      // Zodpovednos≈• - questions about responsibility and accountability
      { categorySlug: 'zodpovednost', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste niesli zodpovednos≈• za d√¥le≈æit√© rozhodnutie alebo projekt.', questionEn: 'Describe a situation where you bore responsibility for an important decision or project.', order: 1 },
      { categorySlug: 'zodpovednost', questionSk: 'Ako zabezpeƒçujete kvalitu a presnos≈• svojej pr√°ce?', questionEn: 'How do you ensure the quality and accuracy of your work?', order: 2 },
      { categorySlug: 'zodpovednost', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste urobili chybu. Ako ste ju rie≈°ili?', questionEn: 'Tell us about a situation where you made a mistake. How did you handle it?', order: 3 },
      { categorySlug: 'zodpovednost', questionSk: 'Ako sa star√°te o dodr≈æiavanie term√≠nov a z√°v√§zkov?', questionEn: 'How do you ensure you meet deadlines and commitments?', order: 4 },

      // Kritick√© myslenie - questions about critical thinking
      { categorySlug: 'kriticke_myslenie', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste spochybnili existuj√∫ci proces alebo postup a navrhli zlep≈°enie.', questionEn: 'Describe a situation where you questioned an existing process or procedure and proposed an improvement.', order: 1 },
      { categorySlug: 'kriticke_myslenie', questionSk: 'Ako overujete spr√°vnos≈• inform√°ci√≠ predt√Ωm, ako ich pou≈æijete pri rozhodovan√≠?', questionEn: 'How do you verify the correctness of information before using it in decision-making?', order: 2 },
      { categorySlug: 'kriticke_myslenie', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste museli vyhodnoti≈• viacer√© protireƒçiv√© inform√°cie.', questionEn: 'Tell us about a situation where you had to evaluate multiple conflicting pieces of information.', order: 3 },
      { categorySlug: 'kriticke_myslenie', questionSk: 'Ako identifikujete potenci√°lne rizik√° v projektoch alebo rozhodnutiach?', questionEn: 'How do you identify potential risks in projects or decisions?', order: 4 },

      // T√≠mov√° pr√°ca - questions about teamwork
      { categorySlug: 'timova_praca', questionSk: 'Op√≠≈°te √∫spe≈°n√Ω projekt, na ktorom ste spolupracovali s kolegami.', questionEn: 'Describe a successful project where you collaborated with colleagues.', order: 1 },
      { categorySlug: 'timova_praca', questionSk: 'Ako prispievate k pozit√≠vnej atmosf√©re v t√≠me?', questionEn: 'How do you contribute to a positive atmosphere in the team?', order: 2 },
      { categorySlug: 'timova_praca', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste rie≈°ili konflikt v t√≠me.', questionEn: 'Tell us about a situation where you resolved a conflict in a team.', order: 3 },
      { categorySlug: 'timova_praca', questionSk: 'Ak√° je va≈°a preferovan√° rola v t√≠me a preƒço?', questionEn: 'What is your preferred role in a team and why?', order: 4 },

      // Uƒçenlivos≈• - questions about learning ability
      { categorySlug: 'ucenlivost', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste sa museli r√Ωchlo nauƒçi≈• nov√∫ oblas≈• alebo zruƒçnos≈•.', questionEn: 'Describe a situation where you had to quickly learn a new area or skill.', order: 1 },
      { categorySlug: 'ucenlivost', questionSk: 'Ako sa vzdel√°vate a roz≈°irujete svoje odborn√© znalosti?', questionEn: 'How do you educate yourself and expand your professional knowledge?', order: 2 },
      { categorySlug: 'ucenlivost', questionSk: 'Povedzte n√°m o situ√°cii, keƒè ste aplikovali nov√© vedomosti v praxi.', questionEn: 'Tell us about a situation where you applied new knowledge in practice.', order: 3 },
      { categorySlug: 'ucenlivost', questionSk: 'Ako prij√≠mate sp√§tn√∫ v√§zbu a uƒç√≠te sa z ch√Ωb?', questionEn: 'How do you receive feedback and learn from mistakes?', order: 4 },

      // Motiv√°cia - questions about motivation and drive
      { categorySlug: 'motivacia', questionSk: 'ƒåo v√°s motivuje pri pr√°ci v ≈°t√°tnej slu≈æbe?', questionEn: 'What motivates you to work in civil service?', order: 1 },
      { categorySlug: 'motivacia', questionSk: 'Op√≠≈°te situ√°ciu, keƒè ste prekroƒçili oƒçak√°vania vo svojej pr√°ci.', questionEn: 'Describe a situation where you exceeded expectations in your work.', order: 2 },
      { categorySlug: 'motivacia', questionSk: 'Ako si udr≈æiavate motiv√°ciu pri rutinn√Ωch alebo n√°roƒçn√Ωch √∫loh√°ch?', questionEn: 'How do you maintain motivation during routine or challenging tasks?', order: 3 },
      { categorySlug: 'motivacia', questionSk: 'Ak√© s√∫ va≈°e profesion√°lne ciele a ako pl√°nujete ich dosiahnu≈•?', questionEn: 'What are your professional goals and how do you plan to achieve them?', order: 4 },
    ]

    const questions = await db.insert(schema.questionBattery).values(questionBatteryData).returning()
    console.log(`‚úÖ Created ${questions.length} questions in battery`)

    console.log('\n‚ú® Database seeding completed successfully!')
    console.log('\nüìä Summary:')
    console.log(`   - ${roles.length} roles`)
    console.log(`   - ${organizations.length} organizations`)
    console.log(`   - ${users.length} users`)
    console.log(`   - ${userOrganizations.length} user-organization relationships`)
    console.log(`   - ${surveys.length} surveys (written exam tests)`)
    console.log(`   - ${procedures.length} procedures`)
    console.log(`   - ${procedureSurveys.length} procedure-survey links`)
    console.log(`   - ${examCriteria.length} exam criteria (oral exam)`)
    console.log(`   - ${contenders.length} contenders`)
    console.log(`   - ${contenderFiles.length} contender files`)
    console.log(`   - ${surveyResponses.length} survey responses (completed tests)`)
    console.log(`   - ${examScores.length} exam scores (oral ratings)`)
    console.log(`   - ${questions.length} question battery items`)
    console.log('\nüîë Staff Login (Keycloak):')
    console.log('   Email: jan.novak@mirri.gov.sk')
    console.log('   Password: password123')
    console.log('\nüéì Test Candidate Access Codes:')
    console.log('   Anna Nov√°kov√°: UC-2025-0001 (ukonƒçen√© v≈°etky testy)')
    console.log('   Peter Horv√°th: UC-2025-0002 (nezaƒçat√©)')
    console.log('   Jana Kov√°ƒçov√°: UC-2025-0003 (ukonƒçen√© v≈°etky testy)')
    console.log('   Martin Szab√≥: UC-2025-0004 (ne√∫spe≈°n√© testy)')
    console.log('   Eva M√©sz√°rosov√°: UC-2025-0005 (ukonƒçen√© testy)')
    console.log('   Luk√°≈° Varga: UC-2025-0006 (nezaƒçat√©)')
    console.log('   Zuzana Moln√°rov√°: UC-2025-0007 (nezaƒçat√©)')
  }
  catch (error) {
    console.error('‚ùå Error seeding database:', error)
    throw error
  }
  finally {
    await client.end()
  }
}

// Run the seeder
seed()
  .then(() => {
    console.log('üëã Exiting...')
    process.exit(0)
  })
  .catch((error) => {
    console.error('üí• Fatal error:', error)
    process.exit(1)
  })
